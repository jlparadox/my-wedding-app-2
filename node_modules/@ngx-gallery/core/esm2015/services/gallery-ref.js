/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
import { BehaviorSubject } from 'rxjs/BehaviorSubject';
import { filter } from 'rxjs/operators/filter';
import { defaultConfig, defaultState } from '../utils/gallery.default';
import { GalleryAction } from '../models';
export class GalleryRef {
    /**
     * @param {?=} config
     * @param {?=} state
     */
    constructor(config = defaultConfig, state = defaultState) {
        this.config = config;
        this.state = state;
        this.state$ = new BehaviorSubject(state);
        this.config$ = new BehaviorSubject(defaultConfig);
        this.setConfig(config);
    }
    /**
     * Set gallery config
     * @param {?} config
     * @return {?}
     */
    setConfig(config) {
        this.config = Object.assign({}, defaultConfig, this.config, config);
        this.config$.next(this.config);
    }
    /**
     * Set gallery state
     * @param {?} state
     * @return {?}
     */
    setState(state) {
        this.state = Object.assign({}, this.state, state);
        this.state$.next(this.state);
    }
    /**
     * Add gallery item
     * @param {?} item - Gallery item object
     * @param {?=} active - Set the new item as current slide
     * @return {?}
     */
    add(item, active) {
        const /** @type {?} */ items = [...this.state.items, item];
        this.setState({
            action: GalleryAction.ITEMS_CHANGED,
            items: items,
            hasNext: items.length > 1,
            currIndex: active ? items.length - 1 : this.state.currIndex
        });
    }
    /**
     * Remove gallery item
     * @param {?} i - Item index
     * @return {?}
     */
    remove(i) {
        const /** @type {?} */ items = [
            ...this.state.items.slice(0, i),
            ...this.state.items.slice(i + 1, this.state.items.length)
        ];
        this.setState({
            action: GalleryAction.ITEMS_CHANGED,
            items: items,
            hasNext: items.length > 1,
            hasPrev: i > 0
        });
    }
    /**
     * Load items and reset the state
     * @param {?} items - Gallery images data
     * @return {?}
     */
    load(items) {
        if (items) {
            this.setState({
                action: GalleryAction.ITEMS_CHANGED,
                items: items,
                hasNext: items.length > 1,
                hasPrev: false
            });
        }
    }
    /**
     * Set active item
     * @param {?} i - Active Index
     * @return {?}
     */
    set(i) {
        if (i !== this.state.currIndex) {
            this.setState({
                action: GalleryAction.INDEX_CHANGED,
                currIndex: i,
                hasNext: i < this.state.items.length - 1,
                hasPrev: i > 0
            });
        }
    }
    /**
     * Next item
     * @return {?}
     */
    next() {
        if (this.state.hasNext) {
            this.set(this.state.currIndex + 1);
        }
        else if (this.config.loop) {
            this.set(0);
        }
    }
    /**
     * Prev item
     * @return {?}
     */
    prev() {
        if (this.state.hasPrev) {
            this.set(this.state.currIndex - 1);
        }
        else if (this.config.loop) {
            this.set(this.state.items.length - 1);
        }
    }
    /**
     * Reset gallery to initial state
     * @return {?}
     */
    reset() {
        this.setState(defaultState);
    }
    /**
     * Destroy GalleryRef (for internal use only)
     * @return {?}
     */
    destroy() {
        this.state$.complete();
        this.config$.complete();
    }
    /**
     * Stream that emits when gallery is initialized/reset
     * @return {?}
     */
    initialized() {
        return this.state$.pipe(filter((state) => state.action === GalleryAction.INITIALIZED));
    }
    /**
     * Stream that emits when items is changed (items loaded, item added, item removed)
     * @return {?}
     */
    itemsChanged() {
        return this.state$.pipe(filter((state) => state.action === GalleryAction.ITEMS_CHANGED));
    }
    /**
     * Stream that emits when current item is changed
     * @return {?}
     */
    indexChanged() {
        return this.state$.pipe(filter((state) => state.action === GalleryAction.INDEX_CHANGED));
    }
}
function GalleryRef_tsickle_Closure_declarations() {
    /** @type {?} */
    GalleryRef.prototype.state$;
    /** @type {?} */
    GalleryRef.prototype.config$;
    /** @type {?} */
    GalleryRef.prototype.config;
    /** @type {?} */
    GalleryRef.prototype.state;
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2FsbGVyeS1yZWYuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9Abmd4LWdhbGxlcnkvY29yZS8iLCJzb3VyY2VzIjpbInNlcnZpY2VzL2dhbGxlcnktcmVmLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFDdkQsT0FBTyxFQUFFLE1BQU0sRUFBRSxNQUFNLHVCQUF1QixDQUFDO0FBRS9DLE9BQU8sRUFBRSxhQUFhLEVBQUUsWUFBWSxFQUFFLE1BQU0sMEJBQTBCLENBQUM7QUFDdkUsT0FBTyxFQUdMLGFBQWEsRUFFZCxNQUFNLFdBQVcsQ0FBQztBQUVuQixNQUFNOzs7OztJQUlKLFlBQ1MsU0FBd0IsYUFBYSxFQUNyQyxRQUFzQixZQUFZO1FBRGxDLFdBQU0sR0FBTixNQUFNO1FBQ04sVUFBSyxHQUFMLEtBQUs7UUFFWixJQUFJLENBQUMsTUFBTSxHQUFHLElBQUksZUFBZSxDQUFlLEtBQUssQ0FBQyxDQUFDO1FBQ3ZELElBQUksQ0FBQyxPQUFPLEdBQUcsSUFBSSxlQUFlLENBQWdCLGFBQWEsQ0FBQyxDQUFDO1FBQ2pFLElBQUksQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLENBQUM7S0FDeEI7Ozs7OztJQU1ELFNBQVMsQ0FBQyxNQUFxQjtRQUM3QixJQUFJLENBQUMsTUFBTSxxQkFBUSxhQUFhLEVBQUssSUFBSSxDQUFDLE1BQU0sRUFBSyxNQUFNLENBQUUsQ0FBQztRQUM5RCxJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7S0FDaEM7Ozs7OztJQU1ELFFBQVEsQ0FBQyxLQUFtQjtRQUMxQixJQUFJLENBQUMsS0FBSyxxQkFBUSxJQUFJLENBQUMsS0FBSyxFQUFLLEtBQUssQ0FBRSxDQUFDO1FBQ3pDLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztLQUM5Qjs7Ozs7OztJ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LENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxDQUFDO1NBQ3ZDO0tBQ0Y7Ozs7O0lBS0QsS0FBSztRQUNILElBQUksQ0FBQyxRQUFRLENBQUMsWUFBWSxDQUFDLENBQUM7S0FDN0I7Ozs7O0lBS0QsT0FBTztRQUNMLElBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxFQUFFLENBQUM7UUFDdkIsSUFBSSxDQUFDLE9BQU8sQ0FBQyxRQUFRLEVBQUUsQ0FBQztLQUN6Qjs7Ozs7SUFPRCxXQUFXO1FBQ1QsTUFBTSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUNyQixNQUFNLENBQ0osQ0FBQyxLQUFtQixFQUFFLEVBQUUsQ0FBQyxLQUFLLENBQUMsTUFBTSxLQUFLLGFBQWEsQ0FBQyxXQUFXLENBQ3BFLENBQ0YsQ0FBQztLQUNIOzs7OztJQUtELFlBQVk7UUFDVixNQUFNLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQ3JCLE1BQU0sQ0FDSixDQUFDLEtBQW1CLEVBQUUsRUFBRSxDQUFDLEtBQUssQ0FBQyxNQUFNLEtBQUssYUFBYSxDQUFDLGFBQWEsQ0FDdEUsQ0FDRixDQUFDO0tBQ0g7Ozs7O0lBS0QsWUFBWTtRQUNWLE1BQU0sQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FDckIsTUFBTSxDQUNKLENBQUMsS0FBbUIsRUFBRSxFQUFFLENBQUMsS0FBSyxDQUFDLE1BQU0sS0FBSyxhQUFhLENBQUMsYUFBYSxDQUN0RSxDQUNGLENBQUM7S0FDSDtDQUNGIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQmVoYXZpb3JTdWJqZWN0IH0gZnJvbSAncnhqcy9CZWhhdmlvclN1YmplY3QnO1xyXG5pbXBvcnQgeyBmaWx0ZXIgfSBmcm9tICdyeGpzL29wZXJhdG9ycy9maWx0ZXInO1xyXG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAncnhqcy9PYnNlcnZhYmxlJztcclxuaW1wb3J0IHsgZGVmYXVsdENvbmZpZywgZGVmYXVsdFN0YXRlIH0gZnJvbSAnLi4vdXRpbHMvZ2FsbGVyeS5kZWZhdWx0JztcclxuaW1wb3J0IHtcclxuICBHYWxsZXJ5U3RhdGUsXHJcbiAgR2FsbGVyeUNvbmZpZyxcclxuICBHYWxsZXJ5QWN0aW9uLFxyXG4gIEdhbGxlcnlJdGVtXHJcbn0gZnJvbSAnLi4vbW9kZWxzJztcclxuXHJcbmV4cG9ydCBjbGFzcyBHYWxsZXJ5UmVmIHtcclxuICBzdGF0ZSQ6IEJlaGF2aW9yU3ViamVjdDxHYWxsZXJ5U3RhdGU+O1xyXG4gIGNvbmZpZyQ6IEJlaGF2aW9yU3ViamVjdDxHYWxsZXJ5Q29uZmlnPjtcclxuXHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBwdWJsaWMgY29uZmlnOiBHYWxsZXJ5Q29uZmlnID0gZGVmYXVsdENvbmZpZyxcclxuICAgIHB1YmxpYyBzdGF0ZTogR2FsbGVyeVN0YXRlID0gZGVmYXVsdFN0YXRlXHJcbiAgKSB7XHJcbiAgICB0aGlzLnN0YXRlJCA9IG5ldyBCZWhhdmlvclN1YmplY3Q8R2FsbGVyeVN0YXRlPihzdGF0ZSk7XHJcbiAgICB0aGlzLmNvbmZpZyQgPSBuZXcgQmVoYXZpb3JTdWJqZWN0PEdhbGxlcnlDb25maWc+KGRlZmF1bHRDb25maWcpO1xyXG4gICAgdGhpcy5zZXRDb25maWcoY29uZmlnKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFNldCBnYWxsZXJ5IGNvbmZpZ1xyXG4gICAqIEBwYXJhbSBjb25maWdcclxuICAgKi9cclxuICBzZXRDb25maWcoY29uZmlnOiBHYWxsZXJ5Q29uZmlnKSB7XHJcbiAgICB0aGlzLmNvbmZpZyA9IHsgLi4uZGVmYXVsdENvbmZpZywgLi4udGhpcy5jb25maWcsIC4uLmNvbmZpZyB9O1xyXG4gICAgdGhpcy5jb25maWckLm5leHQodGhpcy5jb25maWcpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU2V0IGdhbGxlcnkgc3RhdGVcclxuICAgKiBAcGFyYW0gc3RhdGVcclxuICAgKi9cclxuICBzZXRTdGF0ZShzdGF0ZTogR2FsbGVyeVN0YXRlKSB7XHJcbiAgICB0aGlzLnN0YXRlID0geyAuLi50aGlzLnN0YXRlLCAuLi5zdGF0ZSB9O1xyXG4gICAgdGhpcy5zdGF0ZSQubmV4dCh0aGlzLnN0YXRlKTtcclxuICB9XHJcblxyXG4gIC8qKiBBZGQgZ2FsbGVyeSBpdGVtXHJcbiAgICogQHBhcmFtIGl0ZW0gLSBHYWxsZXJ5IGl0ZW0gb2JqZWN0XHJcbiAgICogQHBhcmFtIGFjdGl2ZSAtIFNldCB0aGUgbmV3IGl0ZW0gYXMgY3VycmVudCBzbGlkZVxyXG4gICAqL1xyXG4gIGFkZChpdGVtOiBHYWxsZXJ5SXRlbSwgYWN0aXZlPzogYm9vbGVhbikge1xyXG4gICAgY29uc3QgaXRlbXMgPSBbLi4udGhpcy5zdGF0ZS5pdGVtcywgaXRlbV07XHJcbiAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgYWN0aW9uOiBHYWxsZXJ5QWN0aW9uLklURU1TX0NIQU5HRUQsXHJcbiAgICAgIGl0ZW1zOiBpdGVtcyxcclxuICAgICAgaGFzTmV4dDogaXRlbXMubGVuZ3RoID4gMSxcclxuICAgICAgY3VyckluZGV4OiBhY3RpdmUgPyBpdGVtcy5sZW5ndGggLSAxIDogdGhpcy5zdGF0ZS5jdXJySW5kZXhcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqIFJlbW92ZSBnYWxsZXJ5IGl0ZW1cclxuICAgKiBAcGFyYW0gaSAtIEl0ZW0gaW5kZXhcclxuICAgKi9cclxuICByZW1vdmUoaTogbnVtYmVyKSB7XHJcbiAgICBjb25zdCBpdGVtcyA9IFtcclxuICAgICAgLi4udGhpcy5zdGF0ZS5pdGVtcy5zbGljZSgwLCBpKSxcclxuICAgICAgLi4udGhpcy5zdGF0ZS5pdGVtcy5zbGljZShpICsgMSwgdGhpcy5zdGF0ZS5pdGVtcy5sZW5ndGgpXHJcbiAgICBdO1xyXG4gICAgdGhpcy5zZXRTdGF0ZSh7XHJcbiAgICAgIGFjdGlvbjogR2FsbGVyeUFjdGlvbi5JVEVNU19DSEFOR0VELFxyXG4gICAgICBpdGVtczogaXRlbXMsXHJcbiAgICAgIGhhc05leHQ6IGl0ZW1zLmxlbmd0aCA+IDEsXHJcbiAgICAgIGhhc1ByZXY6IGkgPiAwXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIExvYWQgaXRlbXMgYW5kIHJlc2V0IHRoZSBzdGF0ZVxyXG4gICAqIEBwYXJhbSBpdGVtcyAtIEdhbGxlcnkgaW1hZ2VzIGRhdGFcclxuICAgKi9cclxuICBsb2FkKGl0ZW1zOiBHYWxsZXJ5SXRlbVtdKSB7XHJcbiAgICBpZiAoaXRlbXMpIHtcclxuICAgICAgdGhpcy5zZXRTdGF0ZSh7XHJcbiAgICAgICAgYWN0aW9uOiBHYWxsZXJ5QWN0aW9uLklURU1TX0NIQU5HRUQsXHJcbiAgICAgICAgaXRlbXM6IGl0ZW1zLFxyXG4gICAgICAgIGhhc05leHQ6IGl0ZW1zLmxlbmd0aCA+IDEsXHJcbiAgICAgICAgaGFzUHJldjogZmFsc2VcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTZXQgYWN0aXZlIGl0ZW1cclxuICAgKiBAcGFyYW0gaSAtIEFjdGl2ZSBJbmRleFxyXG4gICAqIEBwYXJhbSBhY3Rpb24gLSBBY3Rpb24gdHlwZVxyXG4gICAqL1xyXG4gIHNldChpOiBudW1iZXIpIHtcclxuICAgIGlmIChpICE9PSB0aGlzLnN0YXRlLmN1cnJJbmRleCkge1xyXG4gICAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgICBhY3Rpb246IEdhbGxlcnlBY3Rpb24uSU5ERVhfQ0hBTkdFRCxcclxuICAgICAgICBjdXJySW5kZXg6IGksXHJcbiAgICAgICAgaGFzTmV4dDogaSA8IHRoaXMuc3RhdGUuaXRlbXMubGVuZ3RoIC0gMSxcclxuICAgICAgICBoYXNQcmV2OiBpID4gMFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIE5leHQgaXRlbVxyXG4gICAqL1xyXG4gIG5leHQoKSB7XHJcbiAgICBpZiAodGhpcy5zdGF0ZS5oYXNOZXh0KSB7XHJcbiAgICAgIHRoaXMuc2V0KHRoaXMuc3RhdGUuY3VyckluZGV4ICsgMSk7XHJcbiAgICB9IGVsc2UgaWYgKHRoaXMuY29uZmlnLmxvb3ApIHtcclxuICAgICAgdGhpcy5zZXQoMCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBQcmV2IGl0ZW1cclxuICAgKi9cclxuICBwcmV2KCkge1xyXG4gICAgaWYgKHRoaXMuc3RhdGUuaGFzUHJldikge1xyXG4gICAgICB0aGlzLnNldCh0aGlzLnN0YXRlLmN1cnJJbmRleCAtIDEpO1xyXG4gICAgfSBlbHNlIGlmICh0aGlzLmNvbmZpZy5sb29wKSB7XHJcbiAgICAgIHRoaXMuc2V0KHRoaXMuc3RhdGUuaXRlbXMubGVuZ3RoIC0gMSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZXNldCBnYWxsZXJ5IHRvIGluaXRpYWwgc3RhdGVcclxuICAgKi9cclxuICByZXNldCgpIHtcclxuICAgIHRoaXMuc2V0U3RhdGUoZGVmYXVsdFN0YXRlKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIERlc3Ryb3kgR2FsbGVyeVJlZiAoZm9yIGludGVybmFsIHVzZSBvbmx5KVxyXG4gICAqL1xyXG4gIGRlc3Ryb3koKSB7XHJcbiAgICB0aGlzLnN0YXRlJC5jb21wbGV0ZSgpO1xyXG4gICAgdGhpcy5jb25maWckLmNvbXBsZXRlKCk7XHJcbiAgfVxyXG5cclxuICAvKiogR2FsbGVyeSBFdmVudHMgKi9cclxuXHJcbiAgLyoqXHJcbiAgICogU3RyZWFtIHRoYXQgZW1pdHMgd2hlbiBnYWxsZXJ5IGlzIGluaXRpYWxpemVkL3Jlc2V0XHJcbiAgICovXHJcbiAgaW5pdGlhbGl6ZWQoKTogT2JzZXJ2YWJsZTxHYWxsZXJ5U3RhdGU+IHtcclxuICAgIHJldHVybiB0aGlzLnN0YXRlJC5waXBlKFxyXG4gICAgICBmaWx0ZXIoXHJcbiAgICAgICAgKHN0YXRlOiBHYWxsZXJ5U3RhdGUpID0+IHN0YXRlLmFjdGlvbiA9PT0gR2FsbGVyeUFjdGlvbi5JTklUSUFMSVpFRFxyXG4gICAgICApXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU3RyZWFtIHRoYXQgZW1pdHMgd2hlbiBpdGVtcyBpcyBjaGFuZ2VkIChpdGVtcyBsb2FkZWQsIGl0ZW0gYWRkZWQsIGl0ZW0gcmVtb3ZlZClcclxuICAgKi9cclxuICBpdGVtc0NoYW5nZWQoKTogT2JzZXJ2YWJsZTxHYWxsZXJ5U3RhdGU+IHtcclxuICAgIHJldHVybiB0aGlzLnN0YXRlJC5waXBlKFxyXG4gICAgICBmaWx0ZXIoXHJcbiAgICAgICAgKHN0YXRlOiBHYWxsZXJ5U3RhdGUpID0+IHN0YXRlLmFjdGlvbiA9PT0gR2FsbGVyeUFjdGlvbi5JVEVNU19DSEFOR0VEXHJcbiAgICAgIClcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTdHJlYW0gdGhhdCBlbWl0cyB3aGVuIGN1cnJlbnQgaXRlbSBpcyBjaGFuZ2VkXHJcbiAgICovXHJcbiAgaW5kZXhDaGFuZ2VkKCk6IE9ic2VydmFibGU8R2FsbGVyeVN0YXRlPiB7XHJcbiAgICByZXR1cm4gdGhpcy5zdGF0ZSQucGlwZShcclxuICAgICAgZmlsdGVyKFxyXG4gICAgICAgIChzdGF0ZTogR2FsbGVyeVN0YXRlKSA9PiBzdGF0ZS5hY3Rpb24gPT09IEdhbGxlcnlBY3Rpb24uSU5ERVhfQ0hBTkdFRFxyXG4gICAgICApXHJcbiAgICApO1xyXG4gIH1cclxufVxyXG4iXX0=