{"version":3,"file":"ngx-gallery-gallerize.js.map","sources":["ng://@ngx-gallery/gallerize/gallerize.directive.ts","ng://@ngx-gallery/gallerize/gallerize.module.ts"],"sourcesContent":["import { Directive, ElementRef, Renderer2, Input, OnInit, OnDestroy, Inject, PLATFORM_ID } from '@angular/core';\nimport { isPlatformBrowser } from '@angular/common';\n\nimport { Gallery, GalleryItem, ImageItem } from '@ngx-gallery/core';\nimport { Lightbox } from '@ngx-gallery/lightbox';\n\nimport { Subject } from 'rxjs/Subject';\nimport { from } from 'rxjs/observable/from';\nimport { empty } from 'rxjs/observable/empty';\nimport { map } from 'rxjs/operators/map';\nimport { tap } from 'rxjs/operators/tap';\nimport { switchMap } from 'rxjs/operators/switchMap';\nimport { debounceTime } from 'rxjs/operators/debounceTime';\nimport { finalize } from 'rxjs/operators';\n\n@Directive({\n  selector: '[gallerize]'\n})\nexport class GallerizeDirective implements OnInit, OnDestroy {\n\n  observer: any;\n  gallerizer$ = new Subject();\n  /** Add images with specific classes to the gallery */\n  @Input() gallerize = 'root';\n  @Input() forClass: string;\n\n  constructor(private _el: ElementRef,\n              private _renderer: Renderer2,\n              private _lightbox: Lightbox,\n              private _gallery: Gallery,\n              @Inject(PLATFORM_ID) private platform: Object) {\n  }\n\n  ngOnInit() {\n\n    /** Get galleryRef */\n    const galleryRef = this._gallery.ref(this.gallerize);\n\n    /** Serialize img classes */\n    const classes = (this.forClass) ? this.forClass.split(' ').map((className) => '.' + className) : '';\n\n    this.gallerizer$.pipe(\n      debounceTime(300),\n      switchMap(() => {\n\n        /** get all img elements from content */\n        const imageElements = this._el.nativeElement.querySelectorAll('img' + classes);\n\n        if (imageElements && imageElements.length) {\n\n          const images: GalleryItem[] = [];\n\n          return from(imageElements).pipe(\n            map((img: HTMLImageElement, i) => {\n              // Add click event to the image\n              this._renderer.setStyle(img, 'cursor', 'pointer');\n              this._renderer.setProperty(img, 'onclick', () => this._lightbox.open(i, this.gallerize));\n              return img;\n            }),\n            tap((img: HTMLImageElement) => images.push(new ImageItem(img.src, img.src))),\n            finalize(() => galleryRef.load(images))\n          );\n        } else {\n          return empty();\n        }\n      })\n    ).subscribe();\n\n    // Observe content changes\n    if (isPlatformBrowser(this.platform)) {\n      this.observer = new MutationObserver(() => this.gallerizer$.next());\n      this.observer.observe(this._el.nativeElement, { childList: true, subtree: true });\n    }\n  }\n\n  ngOnDestroy() {\n    this.gallerizer$.complete();\n    if (this.observer) {\n      this.observer.disconnect();\n    }\n  }\n}\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { GalleryModule } from '@ngx-gallery/core';\r\nimport { LightboxModule } from '@ngx-gallery/lightbox';\r\nimport { GallerizeDirective } from './gallerize.directive';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    GalleryModule,\r\n    LightboxModule\r\n  ],\r\n  declarations: [GallerizeDirective],\r\n  exports: [GallerizeDirective]\r\n})\r\nexport class GallerizeModule {\r\n\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAAA;;;;;;;;IA0BE,YAAoB,GAAe,EACf,WACA,WACA,UACqB;QAJrB,QAAG,GAAH,GAAG,CAAY;QACf,cAAS,GAAT,SAAS;QACT,cAAS,GAAT,SAAS;QACT,aAAQ,GAAR,QAAQ;QACa,aAAQ,GAAR,QAAQ;2BATnC,IAAI,OAAO,EAAE;;;;yBAEN,MAAM;KAQ1B;;;;IAED,QAAQ;;;;QAGN,uBAAM,UAAU,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;;;;QAGrD,uBAAM,OAAO,GAAG,CAAC,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,SAAS,KAAK,GAAG,GAAG,SAAS,CAAC,GAAG,EAAE,CAAC;QAEpG,IAAI,CAAC,WAAW,CAAC,IAAI,CACnB,YAAY,CAAC,GAAG,CAAC,EACjB,SAAS,CAAC;;;;YAGR,uBAAM,aAAa,GAAG,IAAI,CAAC,GAAG,CAAC,aAAa,CAAC,gBAAgB,CAAC,KAAK,GAAG,OAAO,CAAC,CAAC;YAE/E,IAAI,aAAa,IAAI,aAAa,CAAC,MAAM,EAAE;gBAEzC,uBAAM,MAAM,GAAkB,EAAE,CAAC;gBAEjC,OAAO,IAAI,CAAC,aAAa,CAAC,CAAC,IAAI,CAC7B,GAAG,CAAC,CAAC,GAAqB,EAAE,CAAC;;oBAE3B,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,GAAG,EAAE,QAAQ,EAAE,SAAS,CAAC,CAAC;oBAClD,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,GAAG,EAAE,SAAS,EAAE,MAAM,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC;oBACzF,OAAO,GAAG,CAAC;iBACZ,CAAC,EACF,GAAG,CAAC,CAAC,GAAqB,KAAK,MAAM,CAAC,IAAI,CAAC,IAAI,SAAS,CAAC,GAAG,CAAC,GAAG,EAAE,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC,EAC5E,QAAQ,CAAC,MAAM,UAAU,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CACxC,CAAC;aACH;iBAAM;gBACL,OAAO,KAAK,EAAE,CAAC;aAChB;SACF,CAAC,CACH,CAAC,SAAS,EAAE,CAAC;;QAGd,IAAI,iBAAiB,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE;YACpC,IAAI,CAAC,QAAQ,GAAG,IAAI,gBAAgB,CAAC,MAAM,IAAI,CAAC,WAAW,CAAC,IAAI,EAAE,CAAC,CAAC;YACpE,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,aAAa,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC,CAAC;SACnF;KACF;;;;IAED,WAAW;QACT,IAAI,CAAC,WAAW,CAAC,QAAQ,EAAE,CAAC;QAC5B,IAAI,IAAI,CAAC,QAAQ,EAAE;YACjB,IAAI,CAAC,QAAQ,CAAC,UAAU,EAAE,CAAC;SAC5B;KACF;;;YAjEF,SAAS,SAAC;gBACT,QAAQ,EAAE,aAAa;aACxB;;;;YAjBmB,UAAU;YAAE,SAAS;YAIhC,QAAQ;YADR,OAAO;yCA2BD,MAAM,SAAC,WAAW;;;0BAP9B,KAAK;yBACL,KAAK;;;;;;;ACxBR;;;YAMC,QAAQ,SAAC;gBACR,OAAO,EAAE;oBACP,YAAY;oBACZ,aAAa;oBACb,cAAc;iBACf;gBACD,YAAY,EAAE,CAAC,kBAAkB,CAAC;gBAClC,OAAO,EAAE,CAAC,kBAAkB,CAAC;aAC9B;;;;;;;;;;;;;;;;;"}
